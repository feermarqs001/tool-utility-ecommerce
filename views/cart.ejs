<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho de Compras - Tool Utility</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <%- include('partials/header') %>

    <main class="container cart-container">
        <h1>Seu Carrinho de Compras</h1>
        <%- include('partials/flash-messages') %>
        <hr style="margin: 20px 0;">

        <% if (cart && cart.length > 0) { %>
            <div class="cart-items-list">
                <% cart.forEach(item => { %>
                    <div class="cart-item">
                        <img src="<%= (item.product.imageUrls && item.product.imageUrls.length > 0) ? item.product.imageUrls[0] : 'https://via.placeholder.com/150' %>" alt="<%= item.product.name %>">
                        <div class="cart-item-info">
                            <h3><a href="/product/<%= item.product._id %>"><%= item.product.name %></a></h3>
                            <a href="/checkout/cart/remove/<%= item.product._id %>" class="remove-link">Remover</a>
                        </div>
                        <div class="quantity-selector">
                            <a href="/checkout/cart/decrease/<%= item.product._id %>">-</a>
                            <span><%= item.quantity %></span>
                            <a href="/checkout/cart/increase/<%= item.product._id %>">+</a>
                        </div>
                        <div class="cart-item-price">
                            R$ <%= ((item.product.onSale ? item.product.salePrice : item.product.price) * item.quantity).toFixed(2) %>
                        </div>
                    </div>
                <% }) %>
            </div>
            <div class="cart-summary">
                <div class="total-line">
                    <h2>Total:</h2>
                    <h2>R$ <%= total.toFixed(2) %></h2>
                </div>
                <a href="/checkout/review" class="btn">Finalizar Compra</a>
            </div>
        <% } else { %>
            <div class="empty-cart">
                <h2>Seu carrinho est√° vazio.</h2>
                <a href="/" class="btn" style="max-width: 250px; margin: 20px auto 0;">Voltar para a Loja</a>
            </div>
        <% } %>
    </main>

    <%- include('partials/footer') %>
</body>
</html>